rules:
- id: find-sql-string-concatenation
  patterns:
    - pattern-either: 
      - pattern: |
          public $RETURN $METHOD(...,String $X,...){
            ...
            Session $SESSION = ...;
            ...
            String $QUERY = ... + $X + ...;
            ...
            PreparedStatement $PS = $SESSION.connection().prepareStatement($QUERY);
            ...
            ResultSet $RESULT = $PS.executeQuery();
            ...
          }
      - pattern: |
          public $RETURN $METHOD(...,String $X,...){
            ...
            String $QUERY = ... + $X + ...;
            ...
            Session $SESSION = ...;
            ...
            PreparedStatement $PS = $SESSION.connection().prepareStatement($QUERY);
            ...
            ResultSet $RESULT = $PS.executeQuery();
            ...
          }
  message: |
    In $METHOD, $X is used to construct a SQL query via string concatenation.
  fix: |
    Use prepared statment syntax ( "select foo from bar where biz = ? limit 5" ) instead of string conatenation.
  languages: [java] 
  severity: WARNING

